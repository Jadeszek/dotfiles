#!/bin/zsh

HELPER_DIR="/media/windows/Users/philipp"
BACKUP_DIRS=(
             "~"
             "$HELPER_DIR/Documents/Bibliothek"
             "$HELPER_DIR/Pictures"
             "$HELPER_DIR/Music"
            )

SSH_USER="philipp"
SSH_HOST="helo"
SSH_DIR="/home/philipp/backup"

function say() {
    print "[34;1m::[0;37m $*"
}

function die() {
    print "[31;1m::[0;37m $*"
    exit 1
}

say 'Creating dynamic files...'

comm -23 <(pacman -Qeq | sort) <(pacman -Qmq | sort) >~/tmp/pkglist
pacman -Qmq | sort >~/tmp/aurlist

say 'Uploding backup...'

rdup-simple -E ~/.rdup/exclude $BACKUP_DIRS ssh://${SSH_USER}@${SSH_HOST}${SSH_DIR}

say 'Cleaning Up...'

rm -f ~/tmp/pkglist ~/tmp/aurlist

